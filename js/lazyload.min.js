"use strict";!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(window.jQuery||window.Zepto)}(function(h,t){function u(){}function f(t,e){return(e._$container==m?("innerHeight"in y?y.innerHeight:m.height())+m.scrollTop():e._$container.offset().top+e._$container.height())<=t.offset().top-e.threshold}function _(t,e){return(e._$container==m?m.scrollTop():e._$container.offset().top)>=t.offset().top+e.threshold+t.height()}function p(l,i){var c=0;l.each(function(t,e){function a(){o.trigger("_lazyload_appear"),c=0}var r,n,o=l.eq(t);if(!(o.width()<=0&&o.height()<=0||"none"===o.css("display")))if(i.vertical_only){if(!_(o,i))if(f(o,i)){if(++c>i.failure_limit)return!1}else a()}else if(!(_(o,i)||(r=o,((n=i)._$container==m?h.fn.scrollLeft?m.scrollLeft():y.pageXOffset:n._$container.offset().left)>=r.offset().left+n.threshold+r.width())))if(f(o,i)||(n=o,((r=i)._$container==m?m.width()+(h.fn.scrollLeft?m.scrollLeft():y.pageXOffset):r._$container.offset().left+r._$container.width())<=n.offset().left-r.threshold)){if(++c>i.failure_limit)return!1}else a()})}function A(a){return a.filter(function(t,e){return!a.eq(t)._lazyload_loadStarted})}var g,e,y=window,m=h(y),w={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:y,data_attribute:"original",data_srcset_attribute:"original-srcset",skip_invisible:!0,appear:u,load:u,vertical_only:!1,check_appear_throttle_time:300,url_rewriter_fn:u,no_fake_img_loader:!1,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"};e=Object.prototype.toString,g=function(t){return e.call(t).replace("[object ","").replace("]","")},h.fn.hasOwnProperty("lazyload")||(h.fn.lazyload=function(c){var t,f,e,a,r,n,o,l,i,_,s=this;return h.isPlainObject(c)||(c={}),h.each(w,function(t,e){-1!=h.inArray(t,["threshold","failure_limit","check_appear_throttle_time"])?"String"==g(c[t])?c[t]=parseInt(c[t],10):c[t]=e:"container"==t?(!c.hasOwnProperty(t)||c[t]==y||c[t]==document?c._$container=m:c._$container=h(c[t]),delete c.container):!w.hasOwnProperty(t)||c.hasOwnProperty(t)&&g(c[t])==g(w[t])||(c[t]=e)}),t="scroll"==c.event,e=0==c.check_appear_throttle_time?p:(a=p,r=c.check_appear_throttle_time,_=0,function(){n=this,o=arguments;var t=new Date-_;return i||(r<=t?d():i=setTimeout(d,r-t)),l}),f=t||"scrollstart"==c.event||"scrollstop"==c.event,s.each(function(t,e){var r=this,n=s.eq(t),a=n.attr("src"),t=n.attr("data-"+c.data_attribute),o=c.url_rewriter_fn==u?t:c.url_rewriter_fn.call(r,n,t),l=n.attr("data-"+c.data_srcset_attribute),i=n.is("img");return 1==n._lazyload_loadStarted||a==o?(n._lazyload_loadStarted=!0,void(s=A(s))):(n._lazyload_loadStarted=!1,i&&!a&&n.one("error",function(){n.attr("src",c.placeholder_real_img)}).attr("src",c.placeholder_data_img),n.one("_lazyload_appear",function(){function t(){e&&n.hide(),i?(l&&n.attr("srcset",l),o&&n.attr("src",o)):n.css("background-image",'url("'+o+'")'),e&&n[c.effect].apply(n,a?c.effect_params:[]),s=A(s)}var e,a=h.isArray(c.effect_params);n._lazyload_loadStarted||(e="show"!=c.effect&&h.fn[c.effect]&&(!c.effect_params||a&&0==c.effect_params.length),c.appear!=u&&c.appear.call(r,n,s.length,c),n._lazyload_loadStarted=!0,c.no_fake_img_loader||l?(c.load!=u&&n.one("load",function(){c.load.call(r,n,s.length,c)}),t()):h("<img />").one("load",function(){t(),c.load!=u&&c.load.call(r,n,s.length,c)}).attr("src",o))}),void(f||n.on(c.event,function(){n._lazyload_loadStarted||n.trigger("_lazyload_appear")})))}),f&&c._$container.on(c.event,function(){e(s,c)}),m.on("resize load",function(){e(s,c)}),h(function(){e(s,c)}),this;function d(){i=0,_=+new Date,l=a.apply(n,o),o=n=null}})});